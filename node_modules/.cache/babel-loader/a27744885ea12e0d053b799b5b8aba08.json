{"ast":null,"code":"import _objectSpread from\"/Users/koborihiroshi/develop_now/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/koborihiroshi/develop_now/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/koborihiroshi/develop_now/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/koborihiroshi/develop_now/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/koborihiroshi/develop_now/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8,_templateObject9,_templateObject10;import React,{useState,useEffect}from'react';import{createStyles,makeStyles}from'@material-ui/core/styles';import Button from'@material-ui/core/Button';import CreateIcon from'@material-ui/icons/Create';import Container from'@material-ui/core/Container';import styled from'styled-components';import{useForm}from\"react-hook-form\";import Moment from'react-moment';import*as Api from\"../service/api\";import firebase from\"firebase\";import{db}from\"../service/firebase\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var Responce=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  margin: 90px 110px 0px;\\n\"])));var ResPost=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  font-size: 20px;\\n  font-weight: 700;\\n  margin-top: 20px;\\n  border-bottom: 1px dotted #dcdcdc;\\n  padding-bottom: 5px;\\n  margin-bottom: 1em;\\n\"])));var Name=styled.input(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  font-size: 130%;\\n  padding: 8px 14px;\\n  margin-bottom: 15px;\\n  display: block;\\n  border: 1px solid #ccc;\\n  border-radius: 5px;\\n\"])));var MessageArea=styled.textarea(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  font-size: 170%;\\n  padding: 8px 14px;\\n  margin-bottom: 15px;\\n  display: block;\\n  border: 1px solid #ccc;\\n  border-radius: 5px;\\n\"])));var Write=styled(Button)(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n  float: right;\\n  font-size: 20px;\\n\"])));var Bold=styled.b(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n  color: #3f51b5;\\n\"])));var useStyles=makeStyles(function(theme){return createStyles({button:{margin:theme.spacing(1)},root:{flexGrow:1}});});var Post=styled.div(_templateObject7||(_templateObject7=_taggedTemplateLiteral([\"\\n  font-size: 20px;\\n  background-color: #ffffff;\\n  padding: 15px;\\n  margin-bottom: 10px;\\n  border-radius: 5px;\\n  border-style: none solid solid none;\\n  border-color: #ddd;\\n\"])));var Message=styled.div(_templateObject8||(_templateObject8=_taggedTemplateLiteral([\"\\n  padding: 12px 0px;\\n\"])));var ErrorMsg=styled.span(_templateObject9||(_templateObject9=_taggedTemplateLiteral([\"\\n  color: deeppink;\\n  font-weight: 700;\\n\"])));var Main=styled.main(_templateObject10||(_templateObject10=_taggedTemplateLiteral([\"\\n  background-color: #f2f3f7;\\n  padding: 70px 0px 100px;\\n\"])));var Thread=function Thread(){var _useForm=useForm(),register=_useForm.register,setValue=_useForm.setValue,handleSubmit=_useForm.handleSubmit,errors=_useForm.formState.errors;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var onSubmit=function onSubmit(data,e){if(data.name===''){data.name='名無しさん';}db.collection(\"bbs\").add({name:data.name,comment:data.comment,created_at:firebase.firestore.FieldValue.serverTimestamp()}).then(function(res){fetch();setValue('name','');setValue('comment','');e.target.reset();}).catch(function(res){console.log(res);});};var classes=useStyles();useEffect(function(){fetch();},[]);var fetch=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Api.initGet();case 2:data=_context.sent;_context.next=5;return setPosts(data);case 5:case\"end\":return _context.stop();}}},_callee);}));return function fetch(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(Main,{children:/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(\"div\",{className:classes.root,children:posts.map(function(post,index){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Post,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"span\",{children:[index+1,\".  \"]}),/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsxs(Bold,{children:[post.name,\" \"]})}),/*#__PURE__*/_jsx(Moment,{format:\"YYYY\\u5E74MM\\u6708DD\\u65E5 HH:mm:ss \",children:post.created_at})]}),/*#__PURE__*/_jsx(Message,{children:/*#__PURE__*/_jsx(\"span\",{children:post.comment})})]})},index);})}),/*#__PURE__*/_jsxs(Responce,{children:[/*#__PURE__*/_jsx(ResPost,{children:\"\\u30EC\\u30B9\\u3092\\u6295\\u7A3F\\u3059\\u308B\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),children:[errors.name&&/*#__PURE__*/_jsx(ErrorMsg,{children:\"\\u540D\\u524D\\u304C\\u9577\\u3059\\u304E\\u307E\\u3059\\uFF01\"}),/*#__PURE__*/_jsx(Name,_objectSpread(_objectSpread({},register(\"name\",{maxLength:20})),{},{placeholder:'名前(省略可)',size:70})),errors.comment&&/*#__PURE__*/_jsx(ErrorMsg,{children:\"\\u672C\\u6587\\u304C\\u3042\\u308A\\u307E\\u305B\\u3093\\uFF01\"}),/*#__PURE__*/_jsx(MessageArea,_objectSpread(_objectSpread({},register(\"comment\",{required:true})),{},{placeholder:'コメント内容',rows:5,cols:70})),/*#__PURE__*/_jsx(Write,{variant:\"contained\",color:\"primary\",className:classes.button,endIcon:/*#__PURE__*/_jsx(CreateIcon,{}),type:\"submit\",children:\"\\u66F8\\u304D\\u8FBC\\u3080\"})]})]})]})})});};export default Thread;","map":{"version":3,"sources":["/Users/koborihiroshi/develop_now/frontend/src/components/Thread.tsx"],"names":["React","useState","useEffect","createStyles","makeStyles","Button","CreateIcon","Container","styled","useForm","Moment","Api","firebase","db","Responce","div","ResPost","Name","input","MessageArea","textarea","Write","Bold","b","useStyles","theme","button","margin","spacing","root","flexGrow","Post","Message","ErrorMsg","span","Main","main","Thread","register","setValue","handleSubmit","errors","formState","posts","setPosts","onSubmit","data","e","name","collection","add","comment","created_at","firestore","FieldValue","serverTimestamp","then","res","fetch","target","reset","catch","console","log","classes","initGet","map","post","index","maxLength","required"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport CreateIcon from '@material-ui/icons/Create';\nimport Container from '@material-ui/core/Container';\nimport styled from 'styled-components';\nimport { useForm, SubmitHandler } from \"react-hook-form\";\nimport Moment from 'react-moment';\nimport * as Api from \"../service/api\"\nimport firebase from \"firebase\";\nimport { db } from \"../service/firebase\"\n\n\ntype FormInputs = {\n  name: string,\n  comment: string,\n};\n\nconst Responce = styled.div`\n  margin: 90px 110px 0px;\n`\nconst ResPost = styled.div`\n  font-size: 20px;\n  font-weight: 700;\n  margin-top: 20px;\n  border-bottom: 1px dotted #dcdcdc;\n  padding-bottom: 5px;\n  margin-bottom: 1em;\n`\nconst Name = styled.input`\n  width: 100%;\n  font-size: 130%;\n  padding: 8px 14px;\n  margin-bottom: 15px;\n  display: block;\n  border: 1px solid #ccc;\n  border-radius: 5px;\n`\nconst MessageArea = styled.textarea`\n  width: 100%;\n  font-size: 170%;\n  padding: 8px 14px;\n  margin-bottom: 15px;\n  display: block;\n  border: 1px solid #ccc;\n  border-radius: 5px;\n`\n\nconst Write = styled(Button)`\n  float: right;\n  font-size: 20px;\n`\n\nconst Bold = styled.b`\n  color: #3f51b5;\n`\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    button: {\n      margin: theme.spacing(1),\n    },\n    root: {\n      flexGrow: 1,\n    },\n  }),\n);\n\nconst Post = styled.div`\n  font-size: 20px;\n  background-color: #ffffff;\n  padding: 15px;\n  margin-bottom: 10px;\n  border-radius: 5px;\n  border-style: none solid solid none;\n  border-color: #ddd;\n`\nconst Message = styled.div`\n  padding: 12px 0px;\n`\n\nconst ErrorMsg = styled.span`\n  color: deeppink;\n  font-weight: 700;\n`\n\ntype PostType = {\n  name: string;\n  comment: string;\n  created_at: string;\n}\n\nconst Main = styled.main`\n  background-color: #f2f3f7;\n  padding: 70px 0px 100px;\n`\n\nconst Thread: React.FC =  () => {\n  const { register, setValue, handleSubmit, formState: { errors } } = useForm<FormInputs>();\n\n  const [posts, setPosts] = useState<Array<PostType>>([]);\n  \n  const onSubmit: SubmitHandler<FormInputs> = (data: FormInputs, e: any) => {\n    if(data.name === ''){\n      data.name = '名無しさん'\n    }\n    db.collection(\"bbs\").add({\n      name: data.name,\n      comment: data.comment,\n      created_at: firebase.firestore.FieldValue.serverTimestamp(),\n    })\n    .then((res) => {\n      fetch();\n      setValue('name', '')\n      setValue('comment', '')\n      e.target.reset();\n    })\n    .catch((res) => {\n      console.log(res)\n    });\n  };\n\n  const classes = useStyles();\n\n  useEffect(()=>{\n    fetch();\n  }, [])\n\n  const fetch = async() => {\n      const data = await Api.initGet();\n      await setPosts(data);\n  }\n\n  return (\n    <React.Fragment>\n      <Main>\n        <Container>\n          <div className={classes.root}>\n            {posts.map((post, index) => (\n              <div key={index}>\n                <Post>\n                <div>\n                  <span>{index+1}.  </span>\n                  <span>\n                    <Bold>{post.name} </Bold>\n                  </span>\n                  <Moment format=\"YYYY年MM月DD日 HH:mm:ss \">\n                    {post.created_at}\n                  </Moment>\n                </div>\n                <Message>\n                  <span>{post.comment}</span>\n                </Message>\n              </Post>\n              </div>\n            ))}\n          </div>\n          <Responce>\n            <ResPost>レスを投稿する</ResPost>\n            <form onSubmit={handleSubmit(onSubmit)}>\n              {errors.name && <ErrorMsg>名前が長すぎます！</ErrorMsg>}\n              <Name {...register(\"name\", { maxLength: 20 })} placeholder={'名前(省略可)'} size={70} />\n              {errors.comment && <ErrorMsg>本文がありません！</ErrorMsg>}\n              <MessageArea {...register(\"comment\", { required: true })} placeholder={'コメント内容'} rows={5} cols={70} />\n              <Write variant=\"contained\" color=\"primary\" className={classes.button} endIcon={<CreateIcon/>} type='submit'>書き込む</Write>\n            </form>\n          </Responce>\n        </Container>\n      </Main>\n    </React.Fragment>\n  );\n}\n\nexport default Thread;"]},"metadata":{},"sourceType":"module"}